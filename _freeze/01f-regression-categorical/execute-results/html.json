{
  "hash": "977f76e35574b8b404b760152610b8b9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Statistical Modeling\"\nsubtitle: \"Categorical variables\"\nauthor: \"Joris Vankerschaver\"\npdf-engine: lualatex\nformat:\n  beamer:\n    theme: Pittsburgh\n    colortheme: default\n    fonttheme: default\n    include-in-header:\n      - file: header.tex\n---\n\n\n\n\n## Example: BIRNH study\n\n- Epidemiological follow-up study in the mid 80s where nutritional and health data in Belgium were measured ($n=5,815$)\n- **Goal**: effect of smoking on cholesterol\n- Since people from different provinces might have a different smoking and dietary behaviour, we want to correct for province\n- Possible values of this variable:\n  - 1: West Flanders\n  - 2: East Flanders\n  - 3: Flemish Brabant\n  - 7: Antwerp\n  - 8: Limburg\n\n## A first analysis ...\n\n\\footnotesize\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n                Estimate   Std. Error   t value     Pr(>|t|)\n(Intercept) 420.48851244 7.684314e+01  5.472037 4.646481e-08\nSMOKING       1.60405509 1.384697e+00  1.158416 2.467450e-01\nAGE         -14.85347652 4.442769e+00 -3.343292 8.334607e-04\nI(AGE^2)      0.34173838 8.359639e-02  4.087956 4.414182e-05\nI(AGE^3)     -0.00234162 5.126759e-04 -4.567447 5.045194e-06\nSEX           9.77881436 1.290010e+00  7.580415 4.021198e-14\nPROVINCE     -1.68519064 2.307958e-01 -7.301653 3.249025e-13\n```\n\n\n:::\n:::\n\n\n\\normalsize\n\nModel implicitly assumes that mean difference in cholesterol \n\n- between Limburg and West-Flanders is 7 times as large as \n- the one between East- and West-Flanders\n\n\n## Dummy variables\n\n\n- Create 4 **dummy variables**\n\n\\begin{align*}\nP_2 & =  \\left\\{\\begin{array}{ll}\n1 & \\textrm{East Flanders}\\\\\n0 & \\textrm{other}\n\\end{array}\\right.\\\\\nP_3 & = \\left\\{\\begin{array}{ll}\n1 & \\textrm{Flemish Brabant}\\\\\n0 & \\textrm{other}\n\\end{array}\\right.\\\\\nP_7 & =  \\left\\{\\begin{array}{ll}\n1 & \\textrm{Antwerp}\\\\\n0 & \\textrm{other}\n\\end{array}\\right.\\\\\nP_8 & =  \\left\\{\\begin{array}{ll}\n1 & \\textrm{Limburg}\\\\\n0 & \\textrm{other}\n\\end{array}\\right.\\\\\n\\end{align*}\n\n\n## Dummy variables\n\n- These 4 dummy variables carry same information as variable PROVINCE:\n  - In West Flanders: $(P_2,P_3,P_7,P_8)=(0,0,0,0)$\n  - In East Flanders: $(P_2,P_3,P_7,P_8)=(1,0,0,0)$\n  - In Flemish Brabant: $(P_2,P_3,P_7,P_8)=(0,1,0,0)$\n  - In Antwerp: $(P_2,P_3,P_7,P_8)=(0,0,1,0)$\n  - In Limburg: $(P_2,P_3,P_7,P_8)=(0,0,0,1)$\n\n- Each categorical variable with $k$ levels can be transformed into $k-1$ dummy variables by choosing 1 level as **reference**:\n- In \\texttt{R}:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- lm(TCHOL ~ SMOKING + AGE + I(AGE^2) + I(AGE^3) \n        + SEX + factor(PROVINCE))\n```\n:::\n\n\n\n## Analysis with dummy variables\n\n\\scriptsize\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n                       Estimate   Std. Error   t value     Pr(>|t|)\n(Intercept)       427.509211438 7.681468e+01  5.565462 2.738817e-08\nSMOKING             1.691720424 1.383183e+00  1.223063 2.213583e-01\nAGE               -15.186319875 4.440163e+00 -3.420217 6.302833e-04\nI(AGE^2)            0.347689341 8.354742e-02  4.161581 3.208966e-05\nI(AGE^3)           -0.002376407 5.123749e-04 -4.638023 3.599409e-06\nSEX                 9.777916700 1.288500e+00  7.588602 3.777949e-14\nfactor(PROVINCE)2  -8.004574314 2.043346e+00 -3.917385 9.060444e-05\nfactor(PROVINCE)3  -8.332945248 1.487402e+00 -5.602350 2.217790e-08\nfactor(PROVINCE)7 -11.567195456 1.858041e+00 -6.225478 5.157986e-10\nfactor(PROVINCE)8 -13.559736351 1.999453e+00 -6.781721 1.312645e-11\n```\n\n\n:::\n:::\n\n\n\n\\phantom{Necessary to test if multiple coefficients are zero}\n\n## How to test for effect of province?\n\n\\scriptsize\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n                       Estimate   Std. Error   t value     Pr(>|t|)\n(Intercept)       427.509211438 7.681468e+01  5.565462 2.738817e-08\nSMOKING             1.691720424 1.383183e+00  1.223063 2.213583e-01\nAGE               -15.186319875 4.440163e+00 -3.420217 6.302833e-04\nI(AGE^2)            0.347689341 8.354742e-02  4.161581 3.208966e-05\nI(AGE^3)           -0.002376407 5.123749e-04 -4.638023 3.599409e-06\nSEX                 9.777916700 1.288500e+00  7.588602 3.777949e-14\nfactor(PROVINCE)2  -8.004574314 2.043346e+00 -3.917385 9.060444e-05\nfactor(PROVINCE)3  -8.332945248 1.487402e+00 -5.602350 2.217790e-08\nfactor(PROVINCE)7 -11.567195456 1.858041e+00 -6.225478 5.157986e-10\nfactor(PROVINCE)8 -13.559736351 1.999453e+00 -6.781721 1.312645e-11\n```\n\n\n:::\n:::\n\n\n\\normalsize\nNecessary to test if multiple coefficients are zero\n\n## Partial F-test\n\nAssume we want to compare 2 **nested models**:\n\n- **Complete model (C)** with $p_C$ parameters; e.g., $p_C=10$ and\n$$\n  E(Y|X,P)=\\beta_0+\\beta_1X+\\beta_2P\n$$\n- **Reduced model (R)** with $p_R$ parameters; e.g., $p_R=6$ and\n$$\n  E(Y|X,P)=\\beta^*_0+\\beta^*_1X\n$$\n- Testing $H_0:\\beta_2=0$ is equivalent to testing if complete and reduced model are equal.\n\n## Partial F-test\n\n- Under null hypothesis, residual sums of squares of both models will be approximately same.\n- **Test statistic**:\n$$\n  SSE(R) - SSE(C).\n$$\n- What is distribution under null hypothesis?\n$$\n  \\frac{SSE(R) - SSE(C)}{p_C-p_R}\\div \\frac{SSE(C)}{n-p_C}\\sim F_{p_C-p_R,n-p_C}.\n$$\nunder null hypothesis\n\n## Partial F-test in \\texttt{R}\n\n\\footnotesize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmC <- lm(TCHOL ~ SMOKING + AGE + I(AGE^2) + I(AGE^3) + SEX \n         + factor(PROVINCE))\nmR <- lm(TCHOL ~ SMOKING + AGE + I(AGE^2) + I(AGE^3) + SEX)\nanova(mR,mC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: TCHOL ~ SMOKING + AGE + I(AGE^2) + I(AGE^3) + SEX\nModel 2: TCHOL ~ SMOKING + AGE + I(AGE^2) + I(AGE^3) + SEX + factor(PROVINCE)\n  Res.Df      RSS Df Sum of Sq      F    Pr(>F)    \n1   5480 10460957                                  \n2   5476 10329117  4    131840 17.474 2.943e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n",
    "supporting": [
      "01f-regression-categorical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}