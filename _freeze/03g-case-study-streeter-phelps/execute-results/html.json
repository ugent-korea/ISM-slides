{
  "hash": "2ebab4261ba053bac79b1a201034c28b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Modeling and simulation of biosystems\"\nsubtitle: \"Case study: river discharge\"\nauthor: \"Joris Vankerschaver\"\nheader-includes:\n  - \\useinnertheme[shadow=true]{rounded}\n  - \\usecolortheme{rose}\n  - \\setbeamertemplate{footline}[frame number]\n  - \\usepackage{color}\n  - \\usepackage{graphicx}\n  - \\usepackage{siunitx}\n  - \\usepackage{numprint}\noutput: \n  beamer_presentation:\n    theme: \"default\"\n    keep_tex: true\n    includes:\n      in_header: columns.tex\n---\n\n\n\n  \n# Model overview\n  \n---\n  \n## Setting\n\n\\begin{exampleblock}{Streeter-Phelps model}\nUse water pollution as water quality monitoring tool. Describes how dissolved oxygen decreases in a river along a certain distance by degradation of biological oxygen demand.\n\\end{exampleblock}\n\n- Aerobic bacteria gradually remove organic pollution downstream of pollution source\n- Reactions\n  - Aerobic removal of biochemical oxygen demand\n  - Oxygen transfer between atmosphere and water\n- Assumption: plug-flow stream\n- Simple dynamical model (nonlinear)\n\n## Setting\n\nTypical values for rivers\n\n- Biochemical oxygen demand (BOD)\n  - Not polluted: BOD < 1mg/l\n  - Mildly polluted: 2mg/l < BOD < 8mg/l\n- Dissolved oxygen (DO)\n  - Maximal saturation: DO = 12.9mg/l\n  - Typical value in freshwater stream: DO $\\approx$ 9mg/l\n  - Threat to aquatic life: DO < 5mg/l\n\n## Model\n\n\\newcommand{\\BOD}{\\mathsf{BOD}}\n\\newcommand{\\DO}{\\mathsf{DO}}\n\nConstant flow rate: location doesn't matter, dynamic model \\alert{in time}\n\n\\begin{align*}\n  \\frac{d \\BOD}{dt} & = \\BOD_{in} - k_1 \\BOD \\\\\n  \\frac{d \\DO}{dt} & = k_2(\\DO_{sat} - \\DO) - k_1 \\BOD\n\\end{align*}\n\nwhere\n\n- $\\BOD_{in}$: $\\BOD$ flux of waste discharge (mg $\\cdot$ l$^{-1}$ $\\cdot$ min$^{-1}$)\n- $\\DO_{sat}$: dissolved oxygen concentration at saturation\n- $k_1$: deoxygenation rate (min$^{-1}$)\n- $k_2$: reaeration rate, rate at which oxygen can be absorbed from the atmosphere (min$^{-1}$)\n\n## Model inputs\n\n- Initial conditions:\n  - $\\BOD_{t=0} = 7.33$mg/l\n  - $\\DO_{t=0} = 8.5$mg/l\n- Initial model inputs:\n  - $\\BOD_{in} = 1$mg$\\cdot$l$^{-1}$ $\\cdot$min$^{-1}$\n  - $\\DO_{sat} = 8.5$mg$\\cdot$l$^{-1}$\n  - $k_1 = 0.3$min$^{-1}$ (\\alert{unknown})\n  - $k_2 = 0.4$min$^{-1}$ (\\alert{unknown})\n\n## Model trajectories\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n# Parameter estimation\n\n\n## Parameter estimation - simplex method\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Parameter estimation - BFGS\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Optimal parameter result\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Sensitivity analysis\n\n## Absolute sensitivity functions\n\nAbsolute sensitivity of $\\DO$ with respect to $k_1$ and $k_2$.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Difference exact approximate\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Relative sensitivity functions\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Conclusions\n\n- Note difference in values with absolute sensitivities\n- $\\DO$ seems more sensitive to $k_2$ than to $k_1$\n- Extrema at slightly different time points: information concerning correlation between both parameters\n  - Maximal sensitivity at same time point: parameters strongly correlated (impact of change in parameters similar)\n- Studying sensitivity very valuable: sensitivity used in many techniques for model analysis  \n\n## Aside: quality of estimation\n\n- DO measurements at different times: measurement error (obtained manually) is 0.05 mg$\\cdot$l$^{-1}$\n- Estimate simultaneously $k_1$ and $k_2$ (assume all other parameters and initial conditions constant)\n- Gives $k_1 = 0.353$min$^{-1}$, $k_2 = 0.389$\n\n## Quality of estimation: FIM\n\n\n::: {.cell}\n\n:::\n\n\nFisher information matrix:\n\\[\n  \\mathsf{FIM} = \\sum_{i=1}^N \n    \\left(\\frac{\\partial y}{\\partial \\theta}(t_i)\\right)^T Q_i \n    \\left(\\frac{\\partial y}{\\partial \\theta}(t_i)\\right)\n\\]\n\n- Measurement noise $\\sigma_{DO} = 0.05 \\si{mg.l^{-1}}$\n- Weight \"matrix\" in the objective function $Q = \\sigma_{DO}^{-2}$.\n\nGives: \n\\[\n  \\mathsf{FIM} = \\left[\\begin{matrix}\n    \\phantom{-} 3.91 \\cdot 10^{4} & -2.96 \\cdot 10^{4} \\\\\n    -2.96 \\cdot 10^{4} & \\phantom{-} 4.56 \\cdot 10^{5}\n  \\end{matrix}\\right]\n\\]\n\n## Quality of estimation: confidence intervals\n\nError covariance matrix:\n\\[\n  \\mathsf{C} = \\mathsf{FIM}^{-1} = \\left[\n    \\begin{matrix}\n      2.69 \\cdot 10^{-5} & 1.75 \\cdot 10^{-6} \\\\\n      1.75 \\cdot 10^{-6} & 2.31 \\cdot 10^{-6}\n    \\end{matrix}\n  \\right]\n\\]\n\n95% confidence intervals and covariance:\n\n\\begin{align*}\n  k_1 & :  0.353 \\pm 0.011\\\\\n  k_2 & :  0.389 \\pm 0.003\\\\\n  \\mathsf{cor}(k_1, k_2) & = 0.22\n\\end{align*}\n\n## Quantitative analysis\n\n- Calculate $\\delta_{rmsq}$ for $\\DO$ and different parameters\n- Illustration: different measuring schemes for $\\DO$:\n  - Scheme 1: $t_k = 0 : 0.1 : 2$\n  - Scheme 2: $t_k = 0 : 2 : 20$\n  - Scheme 3: $t_k = 0 : 2 : 10$\n  - Scheme 4: $t_k = 10 : 2 : 20$\n\n\n\n::: {.cell}\n\n:::\n\n\n\\begin{center}\n\\scriptsize\n\\begin{tabular}{c|c|c|c|c}\n & \\textsf{Scheme 1} & \\textsf{Scheme 2} & \\textsf{Scheme 3} & \\textsf{Scheme 4} \\\\\n\\hline\n$k_1$ & 0.24 & 0.13 & 0.18 & 0.18 \\\\\n$k_2$ & 0.09 & 0.44 & 0.43 & 0.43 \\\\\n\\scriptsize $\\DO_{sat}$ & 0.49 & 1.32 & 1.23 & 1.23 \\\\\n\\hline\n & $k_2 < k_1 < \\DO_{sat}$ & $k_1 < k_2 < \\DO_{sat}$ & $k_1 < k_2 < \\DO_{sat}$ & $k_1 < k_2 < \\DO_{sat}$ \\\\\n\\end{tabular}\n\\normalsize\n\\end{center}\n\n## GSA: Morris screening: parameter ranges\n\n- Global sensitivity for 6 parameters and initial conditions in designated ranges:\n\n\\begin{gather*}\nk_1: [0.1; 0.6] \\quad k_2: [0.1; 0.6] \\quad \\DO_{sat} : [10; 12] \\\\\n\\BOD_{in} : [0.1; 2] \\quad \\DO_{t=0}: [6; 10] \\quad \\BOD_{t=0}: [6; 10]\n\\end{gather*}\n\n\n## GSA: Morris screening\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nAmong the selected parameters:\n\n- At time 0, $\\DO$ is only sensitive to $\\DO_0$\n- At time 25, $\\DO$ is sensitive to $k_2$ and $\\DO_{sat}$.\n\n## GSA: Monte Carlo\n\n- Monte Carlo: 100 simulations with varying $k_1$ and $k_2$\n- Parameter ranges: $k_1, k_2$ uniformly sampled from $[0.1, 0.8]$\n- Interested in parameter effect at $t = 2$ and $t = 15$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=672 height=50%}\n:::\n:::\n\n\n## GSA: Monte Carlo\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03g-case-study-streeter-phelps_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## GSA: Standardized regression coefficients\n\nPrevious plots show:\n\n- $BOD$ is sensitive to $k_1$ at $t = 2, 15$\n- $DO$ is sensitive to $k_2$ at $t = 15$ (and somewhat at $t = 2$)\n\nRegression coefficients for $DO$ at $t = 15$:\n\\[\n  \\begin{bmatrix}\n    b_1 \\\\ b_2 \n  \\end{bmatrix} = \n    \\begin{bmatrix}\n      -0.342 \\\\ 6.374\n    \\end{bmatrix}.\n\\]\n\nStandardized regression coefficients (using $\\sigma_{k_1} = 0.211$ and $\\sigma_{DO} = 1.887$):\n\\[\n  SRC_{k_1} = -0.038, \\quad \\text{and} \\quad SRC_{k_2} = 0.713.\n\\]\n",
    "supporting": [
      "03g-case-study-streeter-phelps_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}